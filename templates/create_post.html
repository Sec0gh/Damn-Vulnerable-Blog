{% extends "base.html" %}
{% block content %}
<div class="container">
    <div class="card">
        <h2>Create New Post</h2>
        <form id="postForm" method="POST" action="{{ url_for('post.create_post') }}">
            <div class="form-group">
                <label for="title">Title</label>
                <input id="title" name="title" type="text" placeholder="Enter post title" required>
            </div>

            <div class="form-group">
                <label for="content">Content</label>
                <textarea id="content" name="content" rows="6" placeholder="Write your post..." required></textarea>
            </div>

            <button type="submit" class="btn">Publish</button>
            <button type="button" id="previewBtn" class="btn btn-secondary">Preview</button>
        </form>
    </div>

    <div id="previewBox" class="card" style="margin-top: 2rem; display:none;">
        <h2>Preview</h2>
        <div id="previewContent"></div>
    </div>
</div>

<script>
document.getElementById("previewBtn").addEventListener("click", function() {
    const form = document.getElementById("postForm");
    const formData = new FormData(form);

    fetch("{{ url_for('misc.preview_post') }}", {
        method: "POST",
        body: formData
    })
    .then(res => res.text())
    .then(html => {
        document.getElementById("previewBox").style.display = "block";
        document.getElementById("previewContent").innerHTML = html;
    });
});
</script>
{% endblock %}
